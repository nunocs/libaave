\hypertarget{reverb__dattorro_8c}{\section{reverb\-\_\-dattorro.\-c File Reference}
\label{reverb__dattorro_8c}\index{reverb\-\_\-dattorro.\-c@{reverb\-\_\-dattorro.\-c}}
}
{\ttfamily \#include \char`\"{}aave.\-h\char`\"{}}\\*
Include dependency graph for reverb\-\_\-dattorro.\-c\-:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=170pt]{reverb__dattorro_8c__incl}
\end{center}
\end{figure}
\subsection*{Data Structures}
\begin{DoxyCompactItemize}
\item 
struct \hyperlink{structdelay}{delay}
\item 
struct \hyperlink{structlowpass}{lowpass}
\item 
struct \hyperlink{structallpass}{allpass}
\item 
struct \hyperlink{structdecay__block}{decay\-\_\-block}
\end{DoxyCompactItemize}
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{reverb__dattorro_8c_a4ba62d883aa7d24c03fc77da5e644b26}{P\-R\-E\-D\-E\-L\-A\-Y}~(0.\-15 $\ast$ \hyperlink{aave_8h_aff6fdc3178c7698a824bf53f79d0bdd1}{A\-A\-V\-E\-\_\-\-F\-S})
\item 
\#define \hyperlink{reverb__dattorro_8c_ab62aed7f2123c9c915242a259da9f4a8}{B\-A\-N\-D\-W\-I\-D\-T\-H}~0.\-7
\item 
\#define \hyperlink{reverb__dattorro_8c_a2a283ef8c5f46f55546c776f4e40d643}{I\-N\-P\-U\-T\-\_\-\-D\-I\-F\-F\-U\-S\-I\-O\-N\-\_\-1}~0.\-65
\item 
\hypertarget{reverb__dattorro_8c_a2338d0983642474025b7392af39ab413}{\#define {\bfseries I\-N\-P\-U\-T\-\_\-\-D\-I\-F\-F\-U\-S\-I\-O\-N\-\_\-2}~0.\-6}\label{reverb__dattorro_8c_a2338d0983642474025b7392af39ab413}

\item 
\#define \hyperlink{reverb__dattorro_8c_ab21c7a7519116cea2a8d8116e14d5948}{D\-E\-C\-A\-Y\-\_\-\-D\-I\-F\-F\-U\-S\-I\-O\-N\-\_\-1}~0.\-625
\item 
\hypertarget{reverb__dattorro_8c_a4cd885341a90ab62af7804c387fcddf2}{\#define {\bfseries D\-E\-C\-A\-Y\-\_\-\-D\-I\-F\-F\-U\-S\-I\-O\-N\-\_\-2}~0.\-7}\label{reverb__dattorro_8c_a4cd885341a90ab62af7804c387fcddf2}

\item 
\#define \hyperlink{reverb__dattorro_8c_a9d211c41bcae2aa62028a3645c63cf8a}{D\-E\-C\-A\-Y}~0.\-8
\item 
\#define \hyperlink{reverb__dattorro_8c_a7f94005fada4c6d8e87b75924d8f5135}{D\-A\-M\-P\-I\-N\-G}~0.\-7
\item 
\#define \hyperlink{reverb__dattorro_8c_aa0f6b5e01089c6cf7b47c81efb500644}{W\-E\-T}~0.\-3
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
static float \hyperlink{reverb__dattorro_8c_a71156a2bb7fe5562368cb958346b2766}{delay} (struct \hyperlink{structdelay}{delay} $\ast$d, float x, unsigned k)
\item 
static float \hyperlink{reverb__dattorro_8c_a6cd56cc133948b76c116f4fac4f2ea8e}{lowpass} (struct \hyperlink{structlowpass}{lowpass} $\ast$lp, float x, float b)
\item 
static float \hyperlink{reverb__dattorro_8c_a63533538546edde6ae7f3c88192ae6a3}{allpass} (struct \hyperlink{structallpass}{allpass} $\ast$ap, float x, float g, unsigned \hyperlink{structdelay}{delay})
\item 
static void \hyperlink{reverb__dattorro_8c_a32b115d634b84a7f386f1568b00c6a25}{decay\-\_\-block} (struct \hyperlink{structdecay__block}{decay\-\_\-block} $\ast$b, float x, unsigned i, float $\ast$out1, float $\ast$out2, float $\ast$out3)
\item 
void \hyperlink{reverb__dattorro_8c_afe013ab7aabd3541de9962c0de103efd}{aave\-\_\-reverb\-\_\-dattorro} (struct \hyperlink{structaave}{aave} $\ast$\hyperlink{structaave}{aave}, short $\ast$audio, unsigned n)
\end{DoxyCompactItemize}


\subsection{Detailed Description}
The \hyperlink{reverb__dattorro_8c}{reverb\-\_\-dattorro.\-c} file implements a Dattorro reverberator to add an artificial reverberation tail to the output of the auralisation generated by the \hyperlink{audio_8c}{audio.\-c} part of the auralisation process, to simulate the late reflections that the \hyperlink{geometry_8c}{geometry.\-c} part of the auralisation process could not determine in time.

\begin{DoxyRefDesc}{Todo}
\item[\hyperlink{todo__todo000012}{Todo}]Make the code reentrant (move the static structures to aave).\end{DoxyRefDesc}


Reference\-: Jon Dattorro, \char`\"{}\-Effect Design, Part 1\-: Reverberator and Other Filters\char`\"{}, J. Audio Eng. Soc (A\-E\-S), Vol. 45, No 9, Sep 1997. 

\subsection{Macro Definition Documentation}
\hypertarget{reverb__dattorro_8c_ab62aed7f2123c9c915242a259da9f4a8}{\index{reverb\-\_\-dattorro.\-c@{reverb\-\_\-dattorro.\-c}!B\-A\-N\-D\-W\-I\-D\-T\-H@{B\-A\-N\-D\-W\-I\-D\-T\-H}}
\index{B\-A\-N\-D\-W\-I\-D\-T\-H@{B\-A\-N\-D\-W\-I\-D\-T\-H}!reverb_dattorro.c@{reverb\-\_\-dattorro.\-c}}
\subsubsection[{B\-A\-N\-D\-W\-I\-D\-T\-H}]{\setlength{\rightskip}{0pt plus 5cm}\#define B\-A\-N\-D\-W\-I\-D\-T\-H~0.\-7}}\label{reverb__dattorro_8c_ab62aed7f2123c9c915242a259da9f4a8}
Bandwidth of the early low-\/pass filter. \hypertarget{reverb__dattorro_8c_a7f94005fada4c6d8e87b75924d8f5135}{\index{reverb\-\_\-dattorro.\-c@{reverb\-\_\-dattorro.\-c}!D\-A\-M\-P\-I\-N\-G@{D\-A\-M\-P\-I\-N\-G}}
\index{D\-A\-M\-P\-I\-N\-G@{D\-A\-M\-P\-I\-N\-G}!reverb_dattorro.c@{reverb\-\_\-dattorro.\-c}}
\subsubsection[{D\-A\-M\-P\-I\-N\-G}]{\setlength{\rightskip}{0pt plus 5cm}\#define D\-A\-M\-P\-I\-N\-G~0.\-7}}\label{reverb__dattorro_8c_a7f94005fada4c6d8e87b75924d8f5135}
Damping of the late low-\/pass filters. \hypertarget{reverb__dattorro_8c_a9d211c41bcae2aa62028a3645c63cf8a}{\index{reverb\-\_\-dattorro.\-c@{reverb\-\_\-dattorro.\-c}!D\-E\-C\-A\-Y@{D\-E\-C\-A\-Y}}
\index{D\-E\-C\-A\-Y@{D\-E\-C\-A\-Y}!reverb_dattorro.c@{reverb\-\_\-dattorro.\-c}}
\subsubsection[{D\-E\-C\-A\-Y}]{\setlength{\rightskip}{0pt plus 5cm}\#define D\-E\-C\-A\-Y~0.\-8}}\label{reverb__dattorro_8c_a9d211c41bcae2aa62028a3645c63cf8a}
Decay parameter. \hypertarget{reverb__dattorro_8c_ab21c7a7519116cea2a8d8116e14d5948}{\index{reverb\-\_\-dattorro.\-c@{reverb\-\_\-dattorro.\-c}!D\-E\-C\-A\-Y\-\_\-\-D\-I\-F\-F\-U\-S\-I\-O\-N\-\_\-1@{D\-E\-C\-A\-Y\-\_\-\-D\-I\-F\-F\-U\-S\-I\-O\-N\-\_\-1}}
\index{D\-E\-C\-A\-Y\-\_\-\-D\-I\-F\-F\-U\-S\-I\-O\-N\-\_\-1@{D\-E\-C\-A\-Y\-\_\-\-D\-I\-F\-F\-U\-S\-I\-O\-N\-\_\-1}!reverb_dattorro.c@{reverb\-\_\-dattorro.\-c}}
\subsubsection[{D\-E\-C\-A\-Y\-\_\-\-D\-I\-F\-F\-U\-S\-I\-O\-N\-\_\-1}]{\setlength{\rightskip}{0pt plus 5cm}\#define D\-E\-C\-A\-Y\-\_\-\-D\-I\-F\-F\-U\-S\-I\-O\-N\-\_\-1~0.\-625}}\label{reverb__dattorro_8c_ab21c7a7519116cea2a8d8116e14d5948}
Decay diffusion gain of the late all-\/pass filters. \hypertarget{reverb__dattorro_8c_a2a283ef8c5f46f55546c776f4e40d643}{\index{reverb\-\_\-dattorro.\-c@{reverb\-\_\-dattorro.\-c}!I\-N\-P\-U\-T\-\_\-\-D\-I\-F\-F\-U\-S\-I\-O\-N\-\_\-1@{I\-N\-P\-U\-T\-\_\-\-D\-I\-F\-F\-U\-S\-I\-O\-N\-\_\-1}}
\index{I\-N\-P\-U\-T\-\_\-\-D\-I\-F\-F\-U\-S\-I\-O\-N\-\_\-1@{I\-N\-P\-U\-T\-\_\-\-D\-I\-F\-F\-U\-S\-I\-O\-N\-\_\-1}!reverb_dattorro.c@{reverb\-\_\-dattorro.\-c}}
\subsubsection[{I\-N\-P\-U\-T\-\_\-\-D\-I\-F\-F\-U\-S\-I\-O\-N\-\_\-1}]{\setlength{\rightskip}{0pt plus 5cm}\#define I\-N\-P\-U\-T\-\_\-\-D\-I\-F\-F\-U\-S\-I\-O\-N\-\_\-1~0.\-65}}\label{reverb__dattorro_8c_a2a283ef8c5f46f55546c776f4e40d643}
Input diffusion gains of the early all-\/pass filters. \hypertarget{reverb__dattorro_8c_a4ba62d883aa7d24c03fc77da5e644b26}{\index{reverb\-\_\-dattorro.\-c@{reverb\-\_\-dattorro.\-c}!P\-R\-E\-D\-E\-L\-A\-Y@{P\-R\-E\-D\-E\-L\-A\-Y}}
\index{P\-R\-E\-D\-E\-L\-A\-Y@{P\-R\-E\-D\-E\-L\-A\-Y}!reverb_dattorro.c@{reverb\-\_\-dattorro.\-c}}
\subsubsection[{P\-R\-E\-D\-E\-L\-A\-Y}]{\setlength{\rightskip}{0pt plus 5cm}\#define P\-R\-E\-D\-E\-L\-A\-Y~(0.\-15 $\ast$ {\bf A\-A\-V\-E\-\_\-\-F\-S})}}\label{reverb__dattorro_8c_a4ba62d883aa7d24c03fc77da5e644b26}
Pre-\/delay, in number of samples (150ms). \hypertarget{reverb__dattorro_8c_aa0f6b5e01089c6cf7b47c81efb500644}{\index{reverb\-\_\-dattorro.\-c@{reverb\-\_\-dattorro.\-c}!W\-E\-T@{W\-E\-T}}
\index{W\-E\-T@{W\-E\-T}!reverb_dattorro.c@{reverb\-\_\-dattorro.\-c}}
\subsubsection[{W\-E\-T}]{\setlength{\rightskip}{0pt plus 5cm}\#define W\-E\-T~0.\-3}}\label{reverb__dattorro_8c_aa0f6b5e01089c6cf7b47c81efb500644}
Gain of the wet path of the reverberator. 

\subsection{Function Documentation}
\hypertarget{reverb__dattorro_8c_afe013ab7aabd3541de9962c0de103efd}{\index{reverb\-\_\-dattorro.\-c@{reverb\-\_\-dattorro.\-c}!aave\-\_\-reverb\-\_\-dattorro@{aave\-\_\-reverb\-\_\-dattorro}}
\index{aave\-\_\-reverb\-\_\-dattorro@{aave\-\_\-reverb\-\_\-dattorro}!reverb_dattorro.c@{reverb\-\_\-dattorro.\-c}}
\subsubsection[{aave\-\_\-reverb\-\_\-dattorro}]{\setlength{\rightskip}{0pt plus 5cm}void aave\-\_\-reverb\-\_\-dattorro (
\begin{DoxyParamCaption}
\item[{struct {\bf aave} $\ast$}]{aave, }
\item[{short $\ast$}]{audio, }
\item[{unsigned}]{n}
\end{DoxyParamCaption}
)}}\label{reverb__dattorro_8c_afe013ab7aabd3541de9962c0de103efd}
Run a Dattorro reverberator to add an artificial reverberation tail to the {\ttfamily n} binaural frames (2 $\ast$ {\ttfamily n} samples) pointed by {\ttfamily audio}. 

Here is the call graph for this function\-:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{reverb__dattorro_8c_afe013ab7aabd3541de9962c0de103efd_cgraph}
\end{center}
\end{figure}


\hypertarget{reverb__dattorro_8c_a63533538546edde6ae7f3c88192ae6a3}{\index{reverb\-\_\-dattorro.\-c@{reverb\-\_\-dattorro.\-c}!allpass@{allpass}}
\index{allpass@{allpass}!reverb_dattorro.c@{reverb\-\_\-dattorro.\-c}}
\subsubsection[{allpass}]{\setlength{\rightskip}{0pt plus 5cm}static float {\bf allpass} (
\begin{DoxyParamCaption}
\item[{struct {\bf allpass} $\ast$}]{ap, }
\item[{float}]{x, }
\item[{float}]{g, }
\item[{unsigned}]{delay}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{reverb__dattorro_8c_a63533538546edde6ae7f3c88192ae6a3}
Execute an all-\/pass filter\-: H(z) = (g + z$^\wedge$-\/k) / (1 + g z$^\wedge$-\/k). {\ttfamily ap} is the all-\/pass filter data, {\ttfamily x} is the input value, {\ttfamily g} is the gain coefficient, and {\ttfamily delay} is the number of samples of delay. Returns the output value of the all-\/pass filter. \begin{DoxyRefDesc}{Todo}
\item[\hyperlink{todo__todo000013}{Todo}]Check if the tap is really x1 or x2. \end{DoxyRefDesc}


Here is the caller graph for this function\-:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{reverb__dattorro_8c_a63533538546edde6ae7f3c88192ae6a3_icgraph}
\end{center}
\end{figure}


\hypertarget{reverb__dattorro_8c_a32b115d634b84a7f386f1568b00c6a25}{\index{reverb\-\_\-dattorro.\-c@{reverb\-\_\-dattorro.\-c}!decay\-\_\-block@{decay\-\_\-block}}
\index{decay\-\_\-block@{decay\-\_\-block}!reverb_dattorro.c@{reverb\-\_\-dattorro.\-c}}
\subsubsection[{decay\-\_\-block}]{\setlength{\rightskip}{0pt plus 5cm}static void {\bf decay\-\_\-block} (
\begin{DoxyParamCaption}
\item[{struct {\bf decay\-\_\-block} $\ast$}]{b, }
\item[{float}]{x, }
\item[{unsigned}]{i, }
\item[{float $\ast$}]{out1, }
\item[{float $\ast$}]{out2, }
\item[{float $\ast$}]{out3}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{reverb__dattorro_8c_a32b115d634b84a7f386f1568b00c6a25}
Execute a decay block. {\ttfamily b} is the decay block data, {\ttfamily x} is the input value, {\ttfamily i} is the index of the decay block parameters to use (0 or 1), and {\ttfamily out1}, {\ttfamily out2}, {\ttfamily out3} are the output taps. 

Here is the call graph for this function\-:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=242pt]{reverb__dattorro_8c_a32b115d634b84a7f386f1568b00c6a25_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\-:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=296pt]{reverb__dattorro_8c_a32b115d634b84a7f386f1568b00c6a25_icgraph}
\end{center}
\end{figure}


\hypertarget{reverb__dattorro_8c_a71156a2bb7fe5562368cb958346b2766}{\index{reverb\-\_\-dattorro.\-c@{reverb\-\_\-dattorro.\-c}!delay@{delay}}
\index{delay@{delay}!reverb_dattorro.c@{reverb\-\_\-dattorro.\-c}}
\subsubsection[{delay}]{\setlength{\rightskip}{0pt plus 5cm}static float {\bf delay} (
\begin{DoxyParamCaption}
\item[{struct {\bf delay} $\ast$}]{d, }
\item[{float}]{x, }
\item[{unsigned}]{k}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{reverb__dattorro_8c_a71156a2bb7fe5562368cb958346b2766}
Execute a delay block\-: y\mbox{[}n\mbox{]} = x\mbox{[}n -\/ k\mbox{]}. {\ttfamily d} is the delay block data, {\ttfamily x} is the input value, and {\ttfamily k} is the number of samples of delay. Returns the output value y\mbox{[}n\mbox{]}. 

Here is the caller graph for this function\-:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{reverb__dattorro_8c_a71156a2bb7fe5562368cb958346b2766_icgraph}
\end{center}
\end{figure}


\hypertarget{reverb__dattorro_8c_a6cd56cc133948b76c116f4fac4f2ea8e}{\index{reverb\-\_\-dattorro.\-c@{reverb\-\_\-dattorro.\-c}!lowpass@{lowpass}}
\index{lowpass@{lowpass}!reverb_dattorro.c@{reverb\-\_\-dattorro.\-c}}
\subsubsection[{lowpass}]{\setlength{\rightskip}{0pt plus 5cm}static float {\bf lowpass} (
\begin{DoxyParamCaption}
\item[{struct {\bf lowpass} $\ast$}]{lp, }
\item[{float}]{x, }
\item[{float}]{b}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{reverb__dattorro_8c_a6cd56cc133948b76c116f4fac4f2ea8e}
Execute a low-\/pass filter\-: y\mbox{[}n\mbox{]} = b $\ast$ x\mbox{[}n\mbox{]} + (1 -\/ b) $\ast$ y\mbox{[}n-\/1\mbox{]}. {\ttfamily lp} is the low-\/pass filter data, {\ttfamily x} is the input value, {\ttfamily b} is the bandwidth/damping coefficient. Returns the output value y\mbox{[}n\mbox{]}. 

Here is the caller graph for this function\-:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{reverb__dattorro_8c_a6cd56cc133948b76c116f4fac4f2ea8e_icgraph}
\end{center}
\end{figure}


